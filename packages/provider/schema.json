{
  "$schema": "https://raw.githubusercontent.com/pulumi/pulumi/master/pkg/codegen/schema/pulumi.json",
  "name": "verified-permissions-authorizer",
  "version": "0.0.1",
  "description": "Bridged Go component provider that provisions an AWS Verified Permissions Policy Store and a Lambda Authorizer (runtime fixed to nodejs22.x).",
  "keywords": [
    "pulumi",
    "aws",
    "verified-permissions",
    "lambda",
    "authorizer"
  ],
  "repository": "https://github.com/mikecbrant/verified-permissions-authorizer",
  "license": "MIT",
  "types": {},
  "resources": {
    "verified-permissions-authorizer:index:AuthorizerWithPolicyStore": {
      "isComponent": true,
      "inputProperties": {
        "description": {
          "type": "string",
          "description": "Policy store description",
          "plain": true
        },
        "enableDynamoDbStream": {
          "type": "boolean",
          "description": "If true, enable DynamoDB Streams (NEW_AND_OLD_IMAGES) on the tenant table",
          "plain": true,
          "default": false
        },
        "isEphemeral": {
          "type": "boolean",
          "description": "If true, treat the deployment stage as ephemeral (destroy resources on stack removal)",
          "plain": true,
          "default": false
        },
        "lambdaEnvironment": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Additional environment variables for the Lambda authorizer"
        },
        "cognito": {
          "type": "object",
          "description": "Provision an AWS Cognito User Pool and configure it as the Verified Permissions identity source.",
          "properties": {
            "identityPoolFederation": { "type": "boolean" },
            "signInAliases": {
              "type": "object",
              "properties": {
                "username": { "type": "boolean" },
                "email": { "type": "boolean" },
                "phone": { "type": "boolean" },
                "preferredUsername": { "type": "boolean" }
              }
            },
            "emailSendingAccount": { "type": "string", "enum": ["COGNITO_DEFAULT", "DEVELOPER"] },
            "mfa": { "type": "string", "enum": ["OFF", "ON", "OPTIONAL"] },
            "mfaMessage": { "type": "string" },
            "accountRecovery": { "type": "string" },
            "autoVerify": {
              "type": "object",
              "properties": { "email": { "type": "boolean" }, "phone": { "type": "boolean" } }
            },
            "advancedSecurityMode": { "type": "string", "enum": ["OFF", "AUDIT", "ENFORCED"] },
            "userInvitation": {
              "type": "object",
              "properties": { "emailSubject": { "type": "string" }, "emailBody": { "type": "string" }, "smsMessage": { "type": "string" } }
            },
            "userVerification": {
              "type": "object",
              "properties": { "emailSubject": { "type": "string" }, "emailBody": { "type": "string" }, "smsMessage": { "type": "string" } }
            },
            "customAttributes": {
              "type": "object",
              "properties": {
                "globalRoles": { "type": "boolean" },
                "tenantId": { "type": "boolean" },
                "tenantName": { "type": "boolean" },
                "userId": { "type": "boolean" }
              }
            },
            "domain": {
              "type": "object",
              "properties": {
                "domainName": { "type": "string" },
                "certificateArn": { "type": "string" }
              }
            },
            "triggers": {
              "type": "object",
              "additionalProperties": {
                "type": "object",
                "properties": {
                  "enabled": { "type": "boolean" },
                  "environment": { "type": "object", "additionalProperties": { "type": "string" } },
                  "permissions": { "type": "array", "items": { "type": "string" } }
                }
              }
            },
            "clients": { "type": "array", "items": { "type": "string" } }
          }
        }
      },
      "requiredInputs": [],
      "properties": {
        "policyStoreId": {
          "type": "string"
        },
        "policyStoreArn": {
          "type": "string"
        },
        "authorizerFunctionArn": {
          "type": "string"
        },
        "roleArn": {
          "type": "string"
        },
        "TenantTableArn": {
          "type": "string",
          "description": "ARN of the DynamoDB tenant table"
        },
        "TenantTableStreamArn": {
          "type": "string",
          "description": "ARN of the DynamoDB tenant table stream (when streams are enabled)"
        },
        "userPoolId": { "type": "string" },
        "userPoolArn": { "type": "string" },
        "userPoolDomain": { "type": "string" },
        "identityPoolId": { "type": "string" },
        "authRoleArn": { "type": "string" },
        "unauthRoleArn": { "type": "string" },
        "userPoolClientIds": { "type": "array", "items": { "type": "string" } },
        "parameters": { "type": "object", "additionalProperties": { "type": "string" } }
        }
      }
    }
  }
}
